--- a/tls/gnutls/gtlsconnection-gnutls.c	2012-01-04 16:41:15.000000000 +0100
+++ b/tls/gnutls/gtlsconnection-gnutls.c	2012-03-21 11:51:40.803884635 +0100
@@ -1018,6 +1018,7 @@
       g_simple_async_result_set_op_res_gboolean (simple, TRUE);
       g_simple_async_result_complete_in_idle (simple);
       g_object_unref (simple);
+      return;
     }
   else if (!g_error_matches (error, G_IO_ERROR, G_IO_ERROR_WOULD_BLOCK))
     {
@@ -1025,10 +1026,11 @@
       g_error_free (error);
       g_simple_async_result_complete_in_idle (simple);
       g_object_unref (simple);
+      return;
     }
   else if (error)
     g_error_free (error);
-
+    
   source = g_tls_connection_gnutls_create_source (gnutls, 0, cancellable);
   g_source_set_callback (source,
 			 (GSourceFunc) g_tls_connection_gnutls_handshake_ready,
@@ -1221,7 +1223,7 @@
       g_error_free (error);
       g_object_unref (acd->simple);
       if (acd->cancellable)
-	g_object_unref (acd->cancellable);
+        g_object_unref (acd->cancellable);
       g_slice_free (AsyncCloseData, acd);
     }
   else
