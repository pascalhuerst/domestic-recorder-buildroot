From 17d8285659aa05a6c591dcf4c7b2fee46f187af0 Mon Sep 17 00:00:00 2001
From: Oliver Tappe <zooey@hirschkaefer.de>
Date: Tue, 10 Jan 2017 15:48:53 +0100
Subject: [PATCH 2/3] id3v2: Ignore empty frames instead of failing.

---
 taglib/mpeg/id3v2/id3v2tag.cpp | 18 +++++++++---------
 1 file changed, 9 insertions(+), 9 deletions(-)

diff --git a/taglib/mpeg/id3v2/id3v2tag.cpp b/taglib/mpeg/id3v2/id3v2tag.cpp
index 4c00ab6..f8e11c1 100644
--- a/taglib/mpeg/id3v2/id3v2tag.cpp
+++ b/taglib/mpeg/id3v2/id3v2tag.cpp
@@ -759,18 +759,18 @@ void ID3v2::Tag::parse(const ByteVector &origData)
     Frame *frame = d->factory->createFrame(data.mid(frameDataPosition),
                                            &d->header);
 
-    if(!frame)
-      return;
-
     // Checks to make sure that frame parsed correctly.
-
-    if(frame->size() <= 0) {
-      delete frame;
-      return;
+    if(frame) {
+      if(frame->size() > 0) {
+        frameDataPosition += frame->size();
+        addFrame(frame);
+      }
+      else {
+        delete frame;
+      }
     }
 
-    frameDataPosition += frame->size() + Frame::headerSize(d->header.majorVersion());
-    addFrame(frame);
+    frameDataPosition += Frame::headerSize(d->header.majorVersion());
   }
 
   d->factory->rebuildAggregateFrames(this);
-- 
2.7.4

